#pragma once
#include "../util.h"
#define INITGUID  // Include this #define to use SystemTraceControlGuid in Evntrace.h.

#include <windows.h>
#include <stdio.h>
#include <conio.h>
#include <strsafe.h>
#include <wmistr.h>
#include <evntrace.h>

class ETW {
	ULONG status = ERROR_SUCCESS;
	TRACEHANDLE SessionHandle = 0;
	EVENT_TRACE_PROPERTIES* pSessionProperties = NULL;
	STRSAFE_LPCWSTR LOGFILE_PATH;
	ULONG LOG_FILE_SIZE = 512;
public:
	ETW(std::string filename) {
		LOGFILE_PATH = STRSAFE_LPCWSTR(filename.c_str());
	}
	void start();
	void stop();
};
