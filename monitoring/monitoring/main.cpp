#include "procmon/Procmon.cpp"
#include "regshot/RegShot.h"
#include <cstdlib>

int main(int iArgCnt, char** argv)
{
	// init variables
	Procmon procmon(R"(procmon.out)");
	vector <pair<HKEY, wstring>> keys = {
		{ HKEY_CURRENT_USER, L"HKEY_CURRENT_USER"}, 
		{ HKEY_CLASSES_ROOT,L"HKEY_CLASSES_ROOT" },
		{ HKEY_LOCAL_MACHINE,L"HKEY_LOCAL_MACHINE" },
		{ HKEY_USERS ,L"HKEY_USERS" },
		{ HKEY_CURRENT_CONFIG, L"HKEY_CURRENT_CONFIG"}
	};
	RegShot* r = new RegShot(keys);

	// start tasks
	r->takeSnapShot("regshot_before");
	procmon.start();

	// the program to run
	system("start cmd.exe");

	// waiting time
	Sleep(5000);

	// cleanups
	procmon.stop();
	r->takeSnapShot("regshot_after");
	delete r;
	return 0;
}