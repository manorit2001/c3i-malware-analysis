#pragma once

#define _WINSOCK_DEPRECATED_NO_WARNINGS
#include <winsock2.h>
#include <ws2tcpip.h>
#include <iphlpapi.h>
#include <stdio.h>
#include <Psapi.h>
#include <ip2string.h>
#include <fstream>

// #include <winsock.h>

#include <iostream>
#include <string> 

using namespace std;

#pragma comment(lib, "iphlpapi.lib")
#pragma comment(lib, "ws2_32.lib")

#define MALLOC(x) HeapAlloc(GetProcessHeap(), 0, (x))
#define FREE(x) HeapFree(GetProcessHeap(), 0, (x))

class NetworkMon {
	string filename;
	int GetNameByPID(int pid, TCHAR* x);
	void getTCP();
	void getUDP();
	void getUDP6();
	void getTCP6();
	void takesnap() {
		getTCP();
		getUDP();
		getUDP6();
		getTCP6();
	}
public:
	void save(string name) {
		filename = name;
		takesnap();
	}
};