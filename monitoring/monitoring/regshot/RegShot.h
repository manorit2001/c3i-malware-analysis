
#ifndef REGSHOT_H
#define REGSHOT_H


#include <windows.h>
#include <stdio.h>
#include <tchar.h>
#include <cstdio>
#include <iostream>
#include <vector>
#include <string>
#include <fstream>
#include <tchar.h>

#define MAX_KEY_LENGTH 16383
#define MAX_VALUE_NAME 16383

using namespace std;

typedef basic_string<TCHAR> tstring;

class RegShot {
private:
	vector <pair<HKEY, wstring>> rootKeys;
	void printSuitableData(TCHAR* , DWORD , DWORD , vector<BYTE>& , FILE* );
	void recursivelySaveKeys(HKEY , tstring , int , FILE* );
public:
	RegShot(vector <pair<HKEY, wstring>>& );
	void takeSnapShot(string);
};

#endif // !REGSHOT_H