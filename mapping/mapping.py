import csv
from pathlib import Path

from elasticsearch import Elasticsearch, helpers

parsed_dumps = Path("results/parsed_dumps")
csv_files = parsed_dumps.glob("*.csv")

es = Elasticsearch(host="localhost", port=9200)

for csv_file in csv_files:

    with open(parsed_dumps / csv_file.name, "r") as file:

        reader = csv.DictReader(file)
        helpers.bulk(es, reader, index=csv_file.name.split(".")[0])
