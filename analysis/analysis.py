from static_analysis.BasicStaticAnalysis import BasicStaticAnalysis
from static_analysis.DetectAntiTechniques import DetectAntiTechniques
from static_analysis.PEFileInfo import PEFileInfo
from static_analysis.PackerDetection import PackerDetection
from static_analysis.Report import Report
from parsing_IOC.ExtractIOC import ExtractIOC
from detection.signature_based_detection import SignatureBasedDetection


report = Report("static-analysis")

file = "static_analysis/monitoring.exe" # TEST

basic_static_analysis = BasicStaticAnalysis(file)
basic_static_analysis.run("BasicStaticAnalysis")

detect_anti_techniques = DetectAntiTechniques(report)

pe_file_info = PEFileInfo(file)
pe_file_info.run("PEFileInfo")

packer_detection = PackerDetection()

extract_ioc = ExtractIOC()
extract_ioc.run("example.pcap")

signature = SignatureBasedDetection(file)
print(signature.HashDetection())
print(signature.BodyDetection())